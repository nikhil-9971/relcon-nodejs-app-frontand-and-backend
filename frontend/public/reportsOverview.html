<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Reports Overview</title>

    <!-- Poppins font -->
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />

    <script src="https://cdn.tailwindcss.com"></script>

    <style>
      /* Use Poppins everywhere */
      :root {
        --bg: #f5f7fa;
        --muted: #6b7280;
        --card-radius: 14px;
        --accent-opacity: 0.06;
      }

      html,
      body {
        height: 100%;
        font-family: "Poppins", system-ui, -apple-system, "Segoe UI", Roboto,
          "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
        background: var(--bg);
        color: #0f172a;
        margin: 0;
        padding: 0;
      }

      .container {
        max-width: 1200px;
        margin: 28px auto;
        padding: 0 20px;
      }

      .top {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 12px;
        margin-bottom: 22px;
      }

      .title {
        display: flex;
        align-items: center;
        gap: 12px;
      }
      .title h1 {
        font-size: 20px;
        font-weight: 600;
        margin: 0;
        color: #0b1220;
      }

      .search {
        min-width: 280px;
        max-width: 420px;
      }
      .search input {
        width: 100%;
        padding: 10px 14px;
        border-radius: 10px;
        border: 1px solid rgba(15, 23, 42, 0.08);
        background: #fff;
        font-size: 14px;
        box-shadow: 0 1px 0 rgba(2, 6, 23, 0.02);
        outline: none;
      }
      .search input:focus {
        box-shadow: 0 6px 18px rgba(2, 6, 23, 0.06);
        border-color: rgba(59, 130, 246, 0.9);
      }

      /* grid */
      .cards-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
        gap: 18px;
      }

      /* card base */
      .card {
        position: relative;
        display: flex;
        align-items: center;
        gap: 18px;
        padding: 18px 20px;
        border-radius: var(--card-radius);
        background: linear-gradient(180deg, #ffffff, #fbfdff);
        border: 1px solid rgba(15, 23, 42, 0.04);
        cursor: pointer;
        transition: transform 320ms cubic-bezier(0.2, 0.9, 0.3, 1),
          box-shadow 320ms ease, filter 220ms ease;
        min-height: 78px;
        overflow: visible;
        box-shadow: 0 6px 18px rgba(2, 6, 23, 0.04);
      }

      /* left accent bar for identity */
      .card .left-accent {
        width: 8px;
        height: 64px;
        border-radius: 8px;
        flex: 0 0 8px;
      }

      .card .meta {
        flex: 1;
        min-width: 0;
      }

      .card h3 {
        margin: 0;
        font-size: 15px;
        font-weight: 600;
        color: #071326;
      }
      .card p {
        margin: 6px 0 0 0;
        color: var(--muted);
        font-size: 13px;
      }

      /* control (icon box) */
      .card .control {
        width: 44px;
        height: 44px;
        border-radius: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: linear-gradient(
          180deg,
          rgba(255, 255, 255, 0.85),
          rgba(255, 255, 255, 0.7)
        );
        box-shadow: 0 6px 18px rgba(2, 6, 23, 0.04);
        border: 1px solid rgba(15, 23, 42, 0.03);
        flex-shrink: 0;
        color: inherit; /* will be set per theme */
      }

      /* make SVG use currentColor and visible */
      .card .control svg {
        width: 18px;
        height: 18px;
      }
      .card .control svg .stroke {
        stroke: currentColor;
        stroke-width: 2;
        stroke-linecap: round;
        stroke-linejoin: round;
        fill: none;
        stroke-opacity: 0.95;
      }
      .card .control svg .fill {
        fill: currentColor;
        fill-opacity: 0.95;
      }

      /* subtle decorative circle on top-right (soft glass) */
      .card .glow {
        position: absolute;
        right: 14px;
        top: 8px;
        width: 76px;
        height: 76px;
        border-radius: 16px;
        opacity: 0.08;
        pointer-events: none;
      }

      /* hover (3D lift + slight rotate) */
      .card:hover {
        transform: translateY(-10px) rotateX(1deg) scale(1.01);
        box-shadow: 0 26px 44px rgba(3, 10, 24, 0.12),
          0 8px 20px rgba(3, 10, 24, 0.06);
        filter: saturate(1.02);
      }
      .card:active {
        transform: translateY(-4px) rotateX(0.5deg);
      }

      /* color themes */
      .card[data-theme="green"] .left-accent {
        background: linear-gradient(180deg, #06b6a4, #059669);
      }
      .card[data-theme="blue"] .left-accent {
        background: linear-gradient(180deg, #60a5fa, #2563eb);
      }
      .card[data-theme="purple"] .left-accent {
        background: linear-gradient(180deg, #a78bfa, #7c3aed);
      }
      .card[data-theme="orange"] .left-accent {
        background: linear-gradient(180deg, #f6ad55, #f59e0b);
      }
      .card[data-theme="teal"] .left-accent {
        background: linear-gradient(180deg, #34d399, #0d9488);
      }
      .card[data-theme="slate"] .left-accent {
        background: linear-gradient(180deg, #94a3b8, #64748b);
      }
      .card[data-theme="rose"] .left-accent {
        background: linear-gradient(180deg, #fb7185, #f43f5e);
      }

      /* set control color per theme so SVG visible */
      .card[data-theme="green"] .control {
        color: #059669;
      }
      .card[data-theme="blue"] .control {
        color: #2563eb;
      }
      .card[data-theme="purple"] .control {
        color: #7c3aed;
      }
      .card[data-theme="orange"] .control {
        color: #d97706;
      }
      .card[data-theme="teal"] .control {
        color: #0d9488;
      }
      .card[data-theme="slate"] .control {
        color: #475569;
      }
      .card[data-theme="rose"] .control {
        color: #e11d48;
      }

      /* hidden state for restricted cards */
      .card.hidden-by-role {
        display: none !important;
      }

      /* small responsive */
      @media (max-width: 640px) {
        .container {
          margin: 14px;
        }
        .cards-grid {
          grid-template-columns: 1fr;
        }
      }

      /* focus accessibility */
      .card:focus {
        outline: none;
        box-shadow: 0 18px 34px rgba(3, 10, 24, 0.08),
          0 6px 14px rgba(3, 10, 24, 0.05);
        transform: translateY(-8px) scale(1.01);
      }
    </style>
  </head>

  <body>
    <div class="container">
      <div class="top">
        <div class="title" aria-hidden>
          <!-- small multicolor grid icon -->
          <svg
            width="28"
            height="28"
            viewBox="0 0 24 24"
            fill="none"
            aria-hidden
          >
            <rect
              x="2"
              y="3"
              width="7"
              height="7"
              rx="1.5"
              fill="#06b6a4"
            ></rect>
            <rect
              x="15"
              y="3"
              width="7"
              height="7"
              rx="1.5"
              fill="#60a5fa"
            ></rect>
            <rect
              x="2"
              y="14"
              width="7"
              height="7"
              rx="1.5"
              fill="#a78bfa"
            ></rect>
            <rect
              x="15"
              y="14"
              width="7"
              height="7"
              rx="1.5"
              fill="#f6ad55"
            ></rect>
          </svg>
          <h1>Reports</h1>
        </div>

        <div class="search" role="search" aria-label="Search reports">
          <input
            id="reportsSearch"
            type="search"
            placeholder="Search reports..."
            oninput="filterCards()"
          />
        </div>
      </div>

      <div id="cardsContainer" class="cards-grid" role="list">
        <!-- Card: Visit (visible to all) -->
        <div
          class="card"
          data-theme="green"
          data-key="visit"
          onclick="openReport('dataView.html')"
          role="button"
          tabindex="0"
          aria-label="Visit Report"
        >
          <div class="left-accent" aria-hidden></div>
          <div class="meta">
            <h3>Visit Report</h3>
            <p>Visit history & visit-level exports</p>
          </div>
          <div class="control" aria-hidden>
            <svg
              viewBox="0 0 24 24"
              xmlns="http://www.w3.org/2000/svg"
              aria-hidden
            >
              <rect
                class="stroke"
                x="4"
                y="4"
                width="16"
                height="16"
                rx="4"
              ></rect>
            </svg>
          </div>
          <div
            class="glow"
            aria-hidden
            style="
              background: radial-gradient(
                circle at 30% 30%,
                #06b6a4,
                transparent 40%
              );
            "
          ></div>
        </div>

        <!-- HPCL (admin-only) -->
        <div
          class="card"
          data-theme="blue"
          data-key="hpcl"
          data-admin-only="true"
          onclick="openReport('statusRecords.html')"
          role="button"
          tabindex="0"
          aria-label="HPCL Status Report"
        >
          <div class="left-accent" aria-hidden></div>
          <div class="meta">
            <h3>HPCL Status Report</h3>
            <p>Status records for HPCL sites</p>
          </div>
          <div class="control" aria-hidden>
            <svg
              viewBox="0 0 24 24"
              xmlns="http://www.w3.org/2000/svg"
              aria-hidden
            >
              <rect
                class="stroke"
                x="5.5"
                y="5.5"
                width="13"
                height="13"
                rx="3"
              ></rect>
            </svg>
          </div>
          <div
            class="glow"
            aria-hidden
            style="
              background: radial-gradient(
                circle at 30% 30%,
                #60a5fa,
                transparent 40%
              );
            "
          ></div>
        </div>

        <!-- BPCL Visit (visible to all) -->
        <div
          class="card"
          data-theme="purple"
          data-key="bpcl-visit"
          onclick="openReport('bpclVisitReport.html')"
          role="button"
          tabindex="0"
          aria-label="BPCL Visit Report"
        >
          <div class="left-accent" aria-hidden></div>
          <div class="meta">
            <h3>BPCL Visit Report</h3>
            <p>BPCL visit details</p>
          </div>
          <div class="control" aria-hidden>
            <svg
              viewBox="0 0 24 24"
              xmlns="http://www.w3.org/2000/svg"
              aria-hidden
            >
              <rect
                class="stroke"
                x="6"
                y="6"
                width="12"
                height="12"
                rx="3"
              ></rect>
            </svg>
          </div>
          <div
            class="glow"
            aria-hidden
            style="
              background: radial-gradient(
                circle at 30% 30%,
                #a78bfa,
                transparent 40%
              );
            "
          ></div>
        </div>

        <!-- Jio BP (visible to all) -->
        <div
          class="card"
          data-theme="orange"
          data-key="jio-bp"
          onclick="openReport('jioBPreport.html')"
          role="button"
          tabindex="0"
          aria-label="Jio BP Status Report"
        >
          <div class="left-accent" aria-hidden></div>
          <div class="meta">
            <h3>Jio BP Status Report</h3>
            <p>Jio BP records, export & verify</p>
          </div>
          <div class="control" aria-hidden>
            <svg
              viewBox="0 0 24 24"
              xmlns="http://www.w3.org/2000/svg"
              aria-hidden
            >
              <rect
                class="stroke"
                x="5"
                y="5"
                width="14"
                height="14"
                rx="3"
              ></rect>
            </svg>
          </div>
          <div
            class="glow"
            aria-hidden
            style="
              background: radial-gradient(
                circle at 30% 30%,
                #f6ad55,
                transparent 40%
              );
            "
          ></div>
        </div>

        <!-- BPCL Status (visible to all) -->
        <div
          class="card"
          data-theme="teal"
          data-key="bpcl-status"
          onclick="openReport('bpclStatusreport.html')"
          role="button"
          tabindex="0"
          aria-label="BPCL Status Report"
        >
          <div class="left-accent" aria-hidden></div>
          <div class="meta">
            <h3>BPCL Status Report</h3>
            <p>BPCL Status (IOT classes, SIM, ATG)</p>
          </div>
          <div class="control" aria-hidden>
            <svg
              viewBox="0 0 24 24"
              xmlns="http://www.w3.org/2000/svg"
              aria-hidden
            >
              <rect
                class="stroke"
                x="5.5"
                y="5.5"
                width="13"
                height="13"
                rx="3"
              ></rect>
            </svg>
          </div>
          <div
            class="glow"
            aria-hidden
            style="
              background: radial-gradient(
                circle at 30% 30%,
                #34d399,
                transparent 40%
              );
            "
          ></div>
        </div>

        <!-- ATG (admin-only) -->
        <div
          class="card"
          data-theme="slate"
          data-key="atg"
          data-admin-only="true"
          onclick="openReport('atgRecords.html')"
          role="button"
          tabindex="0"
          aria-label="ATG Report"
        >
          <div class="left-accent" aria-hidden></div>
          <div class="meta">
            <h3>ATG Report</h3>
            <p>ATG record exports</p>
          </div>
          <div class="control" aria-hidden>
            <svg
              viewBox="0 0 24 24"
              xmlns="http://www.w3.org/2000/svg"
              aria-hidden
            >
              <rect
                class="stroke"
                x="6"
                y="6"
                width="12"
                height="12"
                rx="3"
              ></rect>
            </svg>
          </div>
          <div
            class="glow"
            aria-hidden
            style="
              background: radial-gradient(
                circle at 30% 30%,
                #94a3b8,
                transparent 40%
              );
            "
          ></div>
        </div>

        <!-- Task (admin-only) -->
        <div
          class="card"
          data-theme="rose"
          data-key="task"
          data-admin-only="true"
          onclick="openReport('taskReport.html')"
          role="button"
          tabindex="0"
          aria-label="Task Report"
        >
          <div class="left-accent" aria-hidden></div>
          <div class="meta">
            <h3>Task Report</h3>
            <p>Task-based reports</p>
          </div>
          <div class="control" aria-hidden>
            <svg
              viewBox="0 0 24 24"
              xmlns="http://www.w3.org/2000/svg"
              aria-hidden
            >
              <rect
                class="stroke"
                x="6.5"
                y="6.5"
                width="11"
                height="11"
                rx="2.5"
              ></rect>
            </svg>
          </div>
          <div
            class="glow"
            aria-hidden
            style="
              background: radial-gradient(
                circle at 30% 30%,
                #fb7185,
                transparent 40%
              );
            "
          ></div>
        </div>

        <!-- Earthing (visible to all) -->
        <div
          class="card"
          data-theme="slate"
          data-key="earthing"
          onclick="openReport('earthingReport.html')"
          role="button"
          tabindex="0"
          aria-label="Earthing Status Report"
        >
          <div class="left-accent" aria-hidden></div>
          <div class="meta">
            <h3>Earthing Status Report</h3>
            <p>Earthing & related checks</p>
          </div>
          <div class="control" aria-hidden>
            <svg
              viewBox="0 0 24 24"
              xmlns="http://www.w3.org/2000/svg"
              aria-hidden
            >
              <rect
                class="stroke"
                x="6"
                y="6"
                width="12"
                height="12"
                rx="3"
              ></rect>
            </svg>
          </div>
          <div
            class="glow"
            aria-hidden
            style="
              background: radial-gradient(
                circle at 30% 30%,
                #94a3b8,
                transparent 40%
              );
            "
          ></div>
        </div>
      </div>

      <div style="margin-top: 18px; color: #6b7280; font-size: 13px">
        Tip: Click on any card to open the report. Use the search box to quickly
        find a report.
      </div>
    </div>

    <script>
      // Read token and return role in lowercase (admin/engineer/...)
      function getRoleFromToken(token) {
        try {
          if (!token) return "";
          const payload = JSON.parse(atob(token.split(".")[1]));
          return (payload.role || "").toString().toLowerCase();
        } catch (e) {
          return "";
        }
      }

      // On load hide admin-only cards for non-admin users
      function applyRoleVisibility() {
        const token = localStorage.getItem("token");
        const role = getRoleFromToken(token);
        const adminOnlyCards = Array.from(
          document.querySelectorAll("[data-admin-only='true']")
        );
        if (role !== "admin") {
          // hide admin-only cards for non-admins (engineer)
          adminOnlyCards.forEach((c) => c.classList.add("hidden-by-role"));
        } else {
          // ensure visible for admin
          adminOnlyCards.forEach((c) => c.classList.remove("hidden-by-role"));
        }
      }

      function openReport(page) {
        try {
          if (window.parent && typeof window.parent.loadPage === "function") {
            window.parent.loadPage(page);
          } else {
            window.top.location.href = page;
          }
        } catch (e) {
          console.error(e);
          window.top.location.href = page;
        }
      }

      function filterCards() {
        const q = (document.getElementById("reportsSearch").value || "")
          .toLowerCase()
          .trim();
        const cards = Array.from(
          document.querySelectorAll("#cardsContainer .card")
        );
        cards.forEach((c) => {
          // if card hidden by role, keep it hidden regardless of search
          if (c.classList.contains("hidden-by-role")) {
            c.style.display = "none";
            return;
          }
          const txt = (c.innerText || "").toLowerCase();
          c.style.display = q === "" || txt.includes(q) ? "" : "none";
        });
      }

      // keyboard accessibility
      document.addEventListener("keydown", function (e) {
        if (e.key === "Enter" || e.key === " ") {
          const active = document.activeElement;
          if (active && active.classList && active.classList.contains("card")) {
            active.click();
            e.preventDefault();
          }
        }
      });

      // initialize on DOM ready
      document.addEventListener("DOMContentLoaded", () => {
        applyRoleVisibility();
      });
    </script>
  </body>
</html>
